# sample config for building android on the machine executor
version: 2
jobs:
   build:
     machine: true
     environment:
      TERM: dumb
      _JAVA_OPTIONS: "-Xmx2048m -XX:+UnlockExperimentalVMOptions -XX:+UseCGroupMemoryLimitForHeap -XX:ParallelGCThreads=2 -XX:ConcGCThreads=2 -XX:ParallelGCThreads=2 -Djava.util.concurrent.ForkJoinPool.common.parallelism=2"
      GRADLE_OPTS: '-Dorg.gradle.jvmargs="-Xmx2048m"'
     steps:
       - checkout
       #- *restore_cache
       #- *attach_build_workspace

       - run: docker pull circleci/android:api-26-alpha
       - run: touch file.txt
       - run: docker cp file.txt circleci/android:api-26-alpha:/foo.txt

       - run:
           name: Gradle build - Common
           command: echo "building android"
           # command: ./gradlew :libs:foursquare-common:assembleRelease --no-daemon -Dkotlin.compiler.execution.strategy=in-proces --stacktrace
       #- persist_to_workspace:
       #    root: *workspace
       #    paths:
       #     - libs/*/build
       #     - ./build-cache
       #     - .gradle
       #- *save_cache